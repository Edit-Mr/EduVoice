<!-- @format -->

<!DOCTYPE html>
<html lang="zh-Hant">
    <head>
        <%- include("partials/meta") %>
        <title><%= ruleData.name %> | å­¸è² EduVoice</title>
        <style>
            main {
                padding-top: 5rem;
                transition: all 0.5s;
            }
            .intro-container {
                display: flex;
                gap: 2rem;
            }
            .intro {
                flex-grow: 1;
            }
            .box {
                background-color: #fff;
                border-radius: 1rem;
                padding: 24px;
                flex-grow: 1;
            }
            .pie-chart {
                flex: 0 0;
                display: flex;
                flex-direction: column;
                white-space: nowrap;
            }
            .pie-box {
                display: flex;
                justify-content: center;
                align-items: center;
                flex-grow: 1;
                min-width: 14rem;
                gap: 2rem;
            }
            .pie {
                width: 10rem;
                height: 10rem;
                border-radius: 50%;
                /* background: conic-gradient(
                    #f00 0% 20%,
                    rgb(163, 163, 163) 20% 30%,
                    #ff0 30% 60%,
                    #0f0 60% 100%
                ); */
            }
            .pie.lol {
                background: conic-gradient(
                    rgb(163, 163, 163) 0% 10%,
                    #ff0 10% 30%,
                    #0f0 30% 100%
                );
            }

            .school-status {
                display: flex;
                flex-wrap: wrap;
                gap: 2rem;
            }
            .school-status > div {
                flex: 1;
            }
            .school-status h2 {
                text-align: center;
            }
            .school-status span {
                text-align: right;
            }
            .school-status a {
                display: flex;
                justify-content: space-between;
                padding: 1rem;
                border-radius: 0.375rem;
                background-color: #f0f0f0;
                margin-bottom: 0.5rem;
                text-decoration: none;
                color: #000;
            }
        </style>
    </head>

    <body class="aemfont-GenWanMin">
        <%- include ("partials/nav") %>
        <main>
            <section>
                <h1><%= schoolData.name %></h1>
                <p><%= schoolData.location %></p>
            </section>
            <section class="intro-container">
                <div class="intro box">
                    <h2>æ ¡åœ’ç°¡ä»‹</h2>
                    <p>
                        <%= schoolData.intro %>
                    </p>
                </div>
                <div class="pie-chart box">
                    <h2>éµå®ˆæ³•è¦</h2>
                    <div class="pie-box">
                        <!-- é€™ä¸€å¡Šæ´¾ä¸ç¢ºå®šè¦çµ±è¨ˆä»€éº¼ -->
                        <div class="pie lol"></div>
                        <div>
                            <div class="green pie-square"></div>
                            å·²å¯¦æ–½ï¼š 30% <br />
                            <div class="yellow pie-square"></div>
                            å¯¦é©—ä¸­ï¼š 10% <br />
                            <div class="red pie-square"></div>
                            æœªå¯¦æ–½ ï¼š 50%<br />
                            <div class="red pie-square"></div>
                            æœªçŸ¥: 10%
                        </div>
                    </div>
                </div>
                <div class="pie-chart box">
                    <h2>æ‰€æœ‰æ”¿ç­–</h2>
                    <div class="pie-box">
                        <div class="pie" id="allPolicies"></div>
                        <div>
                            <div class="green pie-square" ></div>
                            <span id="implemented">å·²å¯¦æ–½ ï¼š</span>
                            <br/>
                            <div class="yellow pie-square"></div>
                            <span id="Testing">å¯¦é©—ä¸­ ï¼š</span>
                            <br />
                            <div class="red pie-square"></div>
                            <span  id="notYet">æœªå¯¦æ–½ ï¼š</span>
                        </div>
                    </div>
                </div>
            </section>
            <% 
            let countDone = 0, countNotYet = 0, countTesting = 0;
            %>
            <section class="school-status">
                <div>
                    <h2>å·²å¯¦æ–½</h2>
                    <% if (ruleData && ruleData.length > 0) { %>
                        
                        <% ruleData.forEach(rule => { %>
                                <%if (rule.status == "O") { %>
                                    <%countDone++;%>
                                    <a href="/i/<%= rule.id %>"><%= rule.title %> <span>âœ…</span></a>
                            <% }}); %>
                    <% } else { %>
                        <p>ç›®å‰æ²’æœ‰è³‡æ–™</p>
                    <% } %>
                </div>
                <div>
                    <h2>å¯¦é©—éšæ®µ / åŠé–‹æ”¾</h2>
                    <% if (ruleData && ruleData.length > 0) { %>
                        
                        <% ruleData.forEach(rule => { %>
                                <%if (rule.status == "?") { %>
                                    <%countTesting++;%>
                                    <!-- <a onclick="alert('æ›´æ–°ç´€éŒ„\nâŒ2023.1.1 ç³¾å¯ŸéšŠé–€å£ç™»è¨˜ (å­¸ç”Ÿ)\nğŸŸ¡ 2024.1.1 ç™»è¨˜ä¸æ‡²è™• (è€å¸«)')">ç©¿ä¾¿æœä¸Šå­¸ <span>ğŸŸ¡</span></a> -->
                                    <a href="/i/<%= rule.id %>"><%= rule.title %> <span>ğŸŸ¡</span></a>
                            <% }}); %>
                    <% } else { %>
                        <p>ç›®å‰æ²’æœ‰è³‡æ–™</p>
                    <% } %>
                </div>
                <div>
                    <h2>æœªå¯¦æ–½</h2>
                    <% if (ruleData && ruleData.length > 0) { %>
                        
                        <% ruleData.forEach(rule => { %>
                                <%if (rule.status == "X") { %>
                                    <%countNotYet++;%>
                                    <a href="/i/<%= rule.id %>"><%= rule.title %> <span>âŒ</span></a>
                            <% }}); %>
                    <% } else { %>
                        <p>ç›®å‰æ²’æœ‰è³‡æ–™</p>
                    <% } %>
                </div>
                <% const totalCount = countDone + countNotYet + countTesting;%>
            </section>
        </main>
        <%
            const Red= ((countNotYet / totalCount) * 100).toFixed(0);
            const yellow= ((countTesting / totalCount) * 100).toFixed(0);
            const green = ((countDone / totalCount) * 100).toFixed(0);
            const pieFalg = totalCount == 0 ? false : true;//è¡¨ç¤ºæ˜¯å¦æœ‰è³‡æ–™
        %>
        <script>
            let pieRed =0;
            //ä¸ç”¨ç®¡ VSC çš„ç´…è‰²æ³¢æµªç·šï¼Œé€™æ˜¯ EJS çš„èªæ³•ï¼Œä¸æ˜¯ JS çš„èªæ³•
            if(<%= pieFalg %>){
                document.getElementById('allPolicies').style.background = `conic-gradient(
                        #f00 0% <%- Red %>%,
                        #ff0 <%- Red %>% <%- Red+yellow %>%,
                        #0f0 <%- Red+yellow %>% 100%
                    )`;
                document.getElementById('notYet').innerText += ` <%- Red %>%`;
                document.getElementById('Testing').innerText += ` <%- yellow %>%`;
                document.getElementById('implemented').innerText += ` <%- green %>%`;
                console.log('red:',<%- Red %>)
            }
            else
            {
                
                document.getElementById('allPolicies').style.background = `conic-gradient(
                        #cfcfcc 0% 100%
                    )`;
                document.getElementById('notYet').innerText ="æ²’æœ‰è³‡æ–™"
                document.getElementById('Testing').innerText="æ²’æœ‰è³‡æ–™"
                document.getElementById('implemented').innerText ="æ²’æœ‰è³‡æ–™"
            }
          </script> 
        <%- include("partials/footer") %>
    </body>
</html>
